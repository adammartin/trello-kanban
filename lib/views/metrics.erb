<html>
  <head>
    <title>Kanban Metrics</title>
    <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/raphael/2.1.4/raphael-min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/morris.js/0.5.1/morris.min.js"></script>
    <style media="screen" type="text/css">
      .morris-hover{position:absolute;z-index:1000;}
      .morris-hover.morris-default-style{border-radius:10px;padding:6px;color:#666;background:rgba(255, 255, 255, 0.8);border:solid 2px rgba(230, 230, 230, 0.8);font-family:sans-serif;font-size:12px;text-align:center;}
      .morris-hover.morris-default-style .morris-hover-row-label{font-weight:bold;margin:0.25em 0;}
      .morris-hover.morris-default-style .morris-hover-point{white-space:nowrap;margin:0.1em 0;}
      .kanban-chart{ width: 60%; min-width: 600px; margin: 0 auto; }
      #legend { height: 50px; background: rgba(90, 90, 90, 0.5); width: 60%; min-width: 600px; margin: 0 auto; font-family:sans-serif; }
      #legend span { display: inline-block; padding: 15px 30px; position: relative; }
      #legend span:after { padding-left: 4px; content: '\00a0\00a0\00a0\00a0\00a0\00a0'; text-decoration: line-through; }
      #metrics { background: rgba(90, 90, 90, 0.5); width: 60%; min-width: 600px; margin: 0 auto; font-family:sans-serif; }
      table.metric_table { border-spacing: 0.5rem; border-color: #000000; text-align: center; width:100% }
      th.metric_table { font-weight: bold;
    </style>
  </head>
  <body>
    <div id="uv-div" class="kanban-chart"></div>
    <div id="legend"></div>
    <div id="metrics">
      <table class="metric_table">
	<tr>
	  <th class="metric_header">Lead Time</th>
	  <th class="metric_headerheader">Cycle Time</th>
	</tr>
	<tr>
	  <td><%=@lead_time%></td>
	  <td><%=@cycle_time%></td>
	</tr>
    </div>
    <script type="text/javascript">
      $(document).ready(function() {
         init();
      });

      function init() {

      var chart = Morris.Area(<%=@graphdef%>);

      chart.options.labels.forEach(function(label, i){
         var legendItem = $('<span></span>').text(label).css('color', chart.options.lineColors[i])
         $('#legend').append(legendItem)
      });

      }
    </script>
  </body>
</html>
